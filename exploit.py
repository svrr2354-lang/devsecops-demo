import requests
import sys

# The URL of your containerized app
# (localhost:5000 is where Docker is running)
url = "http://127.0.0.1:5000/login"

# The malicious payload (The same one you typed manually)
payload = {
    "username": "admin' OR '1'='1",
    "password": "fake_password"
}

print(f"ðŸ”« Attacking {url} with SQL Injection...")

try:
    # Send the login request acting as the attacker
    response = requests.post(url, data=payload)

    # Check if the hack worked
    if "Login successful" in response.text:
        print("\n[!!!] VULNERABILITY CONFIRMED [!!!]")
        print("The application accepted our malicious SQL injection.")
        print("FAILURE: This build is unsafe.")
        # Exit with code 1 (Error) to tell the computer 'Something is wrong'
        sys.exit(1)
    else:
        print("\n[+] Attack Failed. The application appears secure.")
        sys.exit(0)

except Exception as e:
    print(f"Error connecting to target: {e}")
    sys.exit(1)